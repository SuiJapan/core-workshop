---
marp: true
theme: slides
backgroundColor: #0a1628
color: #ffffff
---

![bg cover](../common//cover-bg.svg)

# Move入門

### 目標
• 堅牢な基盤と設計パターンに基づいてSui上にスマートコントラクトを構築する
• Move言語とSui特有のオブジェクト中心モデルを学ぶ

---

# アジェンダ

1. Moveとは？
2. ツールチェーンと環境構築
3. 変数・データ型・可変性
4. Suiのスマートコントラクト設計パターン
5. SuiにおけるCapability（権限）
6. エラー処理とセキュリティ実践

---

# 学習目標

• 重要なポイント: Moveは安全性を重視し、SuiのオブジェクトモデルとCapabilityが高度なパターンを可能にする。
• さらなる学習のためのリソースと演習を紹介。
• 追加リソース: Sui Developer Portal。
(https://sui.io/developers)

---

# Moveとは？

### 安全かつ柔軟
Moveは、Sui上で安全かつ柔軟に動作するスマートコントラクトのために設計されています。

### リソース指向
資産を安全に管理し、リエントランシーのような一般的な脆弱性を防ぎます。

### Suiでの利用
Moveはオンチェーンのオブジェクトを制御し、効率的かつ安全なデータ管理を実現します。

---

# ツールチェーンと環境構築

### **Sui CLIのインストール**
デジタル資産の希少性を保証し、複製を防ぎます。

### **新しいパッケージを初期化**
`sui move new <project>`

---

## 変数・データ型・可変性

### 所有権モデル
変数はRustに類似した所有権規則に従い、メモリ安全性を確保します。

### データ型
- bool: 真偽値（true/false）
- u8, u64: 符号なし整数
- address: アカウント識別子
- vector: 可変長配列

### 可変性
`let` は不変変数を、`let mut` は可変変数を作成します。

(https://move-book.com/reference/primitive-types)

---

# リソースとオブジェクト

### **リソース**
希少性を保証し、デジタル資産の複製を防ぎます。

### **オブジェクト**
Suiの中核データ構造。所有、共有、不変のいずれかになり得ます。

### **所有権**
Wrapping（ラップ）により単一所有を強制し、不正な複製を防ぎます。

### **移転（Transfer）**
`transfer::transfer` を用いて、オブジェクトの所有権を安全に移転します。

---

<!-- class: compact -->

# モジュールと関数

<div class="columns">
<div>

### モジュール
構造体や関数を定義するコード単位で、プロジェクトを整理します。

### 関数
オンチェーンのビジネスロジックを実装するエントリポイントです。

</div>
<div>

### 可視性
**Public:** モジュール外から呼び出し可能
**Private:** モジュール内に限定
**Entry:** トランザクションから呼び出し可能

### 例
Sui上で代替可能トークン（Fungible Token）を作成・管理するモジュール。

</div>
</div>

---

<!-- class: compact-sm -->

## Moveプロジェクトの基本構成

### Move.toml
- プロジェクトの主要な設定ファイル
- プロジェクト名、依存関係、公開アドレスの情報を含む
- Node.jsのpackage.jsonやRustのCargo.tomlに相当

### sources/
- プロジェクトの主要なソースコードを格納するディレクトリ
- .moveファイルにスマートコントラクトのコードを記述
- 各Moveモジュールは別ファイルで定義

### tests/
- テスト用のディレクトリ
- テストファイルは通常 `_test.move` 接尾辞
- スマートコントラクトのユニットテストを記述

---

# 代表的な設計パターン

### データをオブジェクトとして扱う
Suiのモデルはデータをオブジェクト（所有または共有）として保存します。

### SuiのCapability（権限）
Capabilityによってアクセスを制御し、許可された操作のみを許容します。

### One-time Witnessパターン
一意に作成された証明オブジェクトにより、操作を一度だけ実行可能にします。

---

# セキュリティの考慮事項

<div class="columns">
<div>

### ガス最適化
高コストなトランザクションによるサービス拒否を避けるため、コストを最小化します。

</div>
<div>

### リエントランシー対策
リソースモデルによりリエントランシー攻撃を効率的に阻止します。

### 形式検証
重要なコントラクトロジックの正しさを数学的に証明します。

</div>
</div>

---

# 演習

• 参考: Suiドキュメント「はじめてのスマートコントラクト」。
(https://docs.sui.io/guides/developer/writing-your-first-smart-contract)

• スマートコントラクトを実装: トークン作成、所有権移転、Capabilityを用いたリソース管理。

---

# ありがとうございました。
